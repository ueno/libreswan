../../guestbin/swan-prep
west #
 # Run the parser tests.
west #
 ipsec algparse -tp -v1
algparse -v1 'esp' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
	AES_GCM_16_128-NONE
	AES_GCM_16_256-NONE
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_512_256
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=' (expect ERROR)
	ERROR: ESP proposal is empty
algparse -v1 'esp=aes' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=aes;modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-sha1-modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 'esp=aes-128-sha1-modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 'esp=aes-128' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
	AES_CBC_128-HMAC_SHA2_512_256
	AES_CBC_128-HMAC_SHA2_256_128
algparse -v1 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 'esp=3des-sha1;modp1024' (expect ERROR)
	ERROR: ESP DH algorithm 'modp1024' is not supported
algparse -v1 'esp=3des-sha1;modp1536' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP1536 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=3des-sha1;modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=3des-sha1;dh21' (expect ERROR)
	ERROR: ESP DH algorithm 'dh21' is not supported by IKEv1
algparse -v1 'esp=3des-sha1;ecp_521' (expect ERROR)
	ERROR: ESP DH algorithm 'ecp_521' is not supported by IKEv1
algparse -v1 'esp=3des-sha1;dh23' (expect ERROR)
	ERROR: ESP DH algorithm 'dh23' is not supported
algparse -v1 'esp=3des-sha1;dh24' (expect ERROR)
	ERROR: ESP DH algorithm 'dh24' is not supported
algparse -v1 'esp=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=null-sha1' (expect SUCCESS)
	NULL-HMAC_SHA1_96
algparse -v1 'esp=aes_cbc' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=aes-sha' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 'esp=aes-sha2' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=aes-sha256' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=aes-sha384' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_384_192
algparse -v1 'esp=aes-sha512' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256
algparse -v1 'esp=aes128-aes_xcbc' (expect SUCCESS)
	AES_CBC_128-AES_XCBC_96
algparse -v1 'esp=aes192-sha1' (expect SUCCESS)
	AES_CBC_192-HMAC_SHA1_96
algparse -v1 'esp=aes256-sha1' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v1 'esp=aes256-sha' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v1 'esp=aes256-sha2' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v1 'esp=aes256-sha2_256' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v1 'esp=aes256-sha2_384' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_384_192
algparse -v1 'esp=aes256-sha2_512' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_512_256
algparse -v1 'esp=camellia' (expect SUCCESS)
	CAMELLIA_CBC-HMAC_SHA1_96
	CAMELLIA_CBC-HMAC_SHA2_512_256
	CAMELLIA_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=camellia128' (expect SUCCESS)
	CAMELLIA_CBC_128-HMAC_SHA1_96
	CAMELLIA_CBC_128-HMAC_SHA2_512_256
	CAMELLIA_CBC_128-HMAC_SHA2_256_128
algparse -v1 'esp=camellia192' (expect SUCCESS)
	CAMELLIA_CBC_192-HMAC_SHA1_96
	CAMELLIA_CBC_192-HMAC_SHA2_512_256
	CAMELLIA_CBC_192-HMAC_SHA2_256_128
algparse -v1 'esp=camellia256' (expect SUCCESS)
	CAMELLIA_CBC_256-HMAC_SHA1_96
	CAMELLIA_CBC_256-HMAC_SHA2_512_256
	CAMELLIA_CBC_256-HMAC_SHA2_256_128
algparse -v1 'esp=aes_ccm' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 'esp=aes_ccm_a-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v1 'esp=aes_ccm_a-192-null' (expect SUCCESS)
	AES_CCM_8_192-NONE
algparse -v1 'esp=aes_ccm_a-256-null' (expect SUCCESS)
	AES_CCM_8_256-NONE
algparse -v1 'esp=aes_ccm_b-128-null' (expect SUCCESS)
	AES_CCM_12_128-NONE
algparse -v1 'esp=aes_ccm_b-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v1 'esp=aes_ccm_b-256-null' (expect SUCCESS)
	AES_CCM_12_256-NONE
algparse -v1 'esp=aes_ccm_c-128-null' (expect SUCCESS)
	AES_CCM_16_128-NONE
algparse -v1 'esp=aes_ccm_c-192-null' (expect SUCCESS)
	AES_CCM_16_192-NONE
algparse -v1 'esp=aes_ccm_c-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 'esp=aes_gcm' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 'esp=aes_gcm_a-192-null' (expect SUCCESS)
	AES_GCM_8_192-NONE
algparse -v1 'esp=aes_gcm_a-256-null' (expect SUCCESS)
	AES_GCM_8_256-NONE
algparse -v1 'esp=aes_gcm_b-128-null' (expect SUCCESS)
	AES_GCM_12_128-NONE
algparse -v1 'esp=aes_gcm_b-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v1 'esp=aes_gcm_b-256-null' (expect SUCCESS)
	AES_GCM_12_256-NONE
algparse -v1 'esp=aes_gcm_c-128-null' (expect SUCCESS)
	AES_GCM_16_128-NONE
algparse -v1 'esp=aes_gcm_c-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v1 'esp=aes_gcm_c-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v1 'esp=aes_ccm_a-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v1 'esp=aes_ccm_b-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v1 'esp=aes_ccm_c-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 'esp=aes_gcm_a-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v1 'esp=aes_gcm_b-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v1 'esp=aes_gcm_c-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 'esp=aes_ccm-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 'esp=aes_gcm-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 'esp=aes_ccm-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 'esp=aes_gcm-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v1 'esp=aes_ccm_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 'esp=aes_gcm_192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v1 'esp=aes_ccm_8-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v1 'esp=aes_ccm_12-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v1 'esp=aes_ccm_16-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 'esp=aes_gcm_8-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v1 'esp=aes_gcm_12-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v1 'esp=aes_gcm_16-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 'esp=aes_ccm_8-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v1 'esp=aes_ccm_12-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v1 'esp=aes_ccm_16-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 'esp=aes_gcm_8-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 'esp=aes_gcm_12-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v1 'esp=aes_gcm_16-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v1 'esp=aes_ccm_8_128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v1 'esp=aes_ccm_12_192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v1 'esp=aes_ccm_16_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 'esp=aes_gcm_8_128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 'esp=aes_gcm_12_192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v1 'esp=aes_gcm_16_256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v1 'esp=aes_ctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA1_96
	AES_CTR-HMAC_SHA2_512_256
	AES_CTR-HMAC_SHA2_256_128
algparse -v1 'esp=aesctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA1_96
	AES_CTR-HMAC_SHA2_512_256
	AES_CTR-HMAC_SHA2_256_128
algparse -v1 'esp=aes_ctr128' (expect SUCCESS)
	AES_CTR_128-HMAC_SHA1_96
	AES_CTR_128-HMAC_SHA2_512_256
	AES_CTR_128-HMAC_SHA2_256_128
algparse -v1 'esp=aes_ctr192' (expect SUCCESS)
	AES_CTR_192-HMAC_SHA1_96
	AES_CTR_192-HMAC_SHA2_512_256
	AES_CTR_192-HMAC_SHA2_256_128
algparse -v1 'esp=aes_ctr256' (expect SUCCESS)
	AES_CTR_256-HMAC_SHA1_96
	AES_CTR_256-HMAC_SHA2_512_256
	AES_CTR_256-HMAC_SHA2_256_128
algparse -v1 'esp=camellia_cbc_256-hmac_sha2_512_256;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	CAMELLIA_CBC_256-HMAC_SHA2_512_256
algparse -v1 'esp=null_auth_aes_gmac_256-null;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	NULL_AUTH_AES_GMAC_256-NONE
algparse -v1 'esp=3des-sha1;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=3des-sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-sha1,3des-sha1;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-sha1-modp8192,3des-sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
algparse -v1 'esp=aes;none' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 'esp=aes;none,aes' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 'esp=aes;none,aes;modp2048' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 'esp=aes-sha1-none' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 'esp=aes-sha1;none' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 'esp=3des168-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 3DES_CBC does not allow a key lengths
algparse -v1 'esp=3des-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm 3DES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v1 'esp=aes128-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm AES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v1 'esp=aes224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v1 'esp=aes-224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v1 'esp=aes0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v1 'esp=aes-0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v1 'esp=aes512-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 512 invalid; valid key lengths: 128, 192, 256
algparse -v1 'esp=aes-sha1555' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha1555' is not recognized
algparse -v1 'esp=camellia666-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm CAMELLIA_CBC with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v1 'esp=blowfish' (expect ERROR)
	ERROR: ESP encryption algorithm 'blowfish' is not supported
algparse -v1 'esp=des-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 'des' is not supported
algparse -v1 'esp=aes_ctr666' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CTR with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v1 'esp=aes128-sha2_128' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha2_128' is not recognized
algparse -v1 'esp=aes256-sha2_256-4096' (expect ERROR)
	ERROR: ESP DH algorithm '4096' is not recognized
algparse -v1 'esp=aes256-sha2_256-128' (expect ERROR)
	ERROR: ESP DH algorithm '128' is not recognized
algparse -v1 'esp=vanitycipher' (expect ERROR)
	ERROR: ESP encryption algorithm 'vanitycipher' is not recognized
algparse -v1 'esp=ase-sah' (expect ERROR)
	ERROR: ESP encryption algorithm 'ase' is not recognized
algparse -v1 'esp=aes-sah1' (expect ERROR)
	ERROR: ESP integrity algorithm 'sah1' is not recognized
algparse -v1 'esp=id3' (expect ERROR)
	ERROR: ESP encryption algorithm 'id3' is not recognized
algparse -v1 'esp=aes-id3' (expect ERROR)
	ERROR: ESP integrity algorithm 'id3' is not recognized
algparse -v1 'esp=aes_gcm-md5' (expect ERROR)
	ERROR: AEAD ESP encryption algorithm AES_GCM_16 must have 'NONE' as the integrity algorithm
algparse -v1 'esp=mars' (expect ERROR)
	ERROR: ESP encryption algorithm 'mars' is not supported
algparse -v1 'esp=aes_gcm-16' (expect ERROR)
	ERROR: ESP encryption algorithm AES_GCM_16 with key length 16 invalid; valid key lengths: 128, 192, 256
algparse -v1 'esp=aes_gcm-0' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v1 'esp=aes_gcm-123456789012345' (expect ERROR)
	ERROR: ESP encryption algorithm 'aes_gcm-123456789012345' key length WAY too big
algparse -v1 'esp=3des-sha1;dh22' (expect ERROR)
	ERROR: ESP DH algorithm 'dh22' is not supported
algparse -v1 'esp=3des-sha1;modp8192,3des-sha2' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=3des-sha1-modp8192,3des-sha2' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=3des-sha1-modp8192,3des-sha2-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=3des-sha1-modp8192,3des-sha2;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=3des-sha1;modp8192,3des-sha2-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=3des-sha1;modp8192,3des-sha2;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'esp=3des-sha1-modp8192,3des-sha2-modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 'ah' (expect SUCCESS)
	HMAC_SHA1_96
	HMAC_SHA2_512_256
	HMAC_SHA2_256_128
algparse -v1 'ah=' (expect ERROR)
	ERROR: AH proposal is empty
algparse -v1 'ah=md5' (expect SUCCESS)
	HMAC_MD5_96
algparse -v1 'ah=sha' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v1 'ah=sha;modp2048' (expect SUCCESS)
ipsec algparse: ignoring AH DH algorithm MODP2048 as PFS policy is disabled
	HMAC_SHA1_96
algparse -v1 'ah=sha1' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v1 'ah=sha2' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v1 'ah=sha256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v1 'ah=sha384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v1 'ah=sha512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v1 'ah=sha2_256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v1 'ah=sha2_384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v1 'ah=sha2_512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v1 'ah=aes_xcbc' (expect SUCCESS)
	AES_XCBC_96
algparse -v1 'ah=sha2-none' (expect ERROR)
	ERROR: AH DH algorithm 'none' is not supported by IKEv1
algparse -v1 'ah=sha2;none' (expect ERROR)
	ERROR: AH DH algorithm 'none' is not supported by IKEv1
algparse -v1 'ah=sha1-modp8192,sha1-modp8192,sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring AH DH algorithm MODP8192 as PFS policy is disabled
	HMAC_SHA1_96
algparse -v1 'ah=aes-sha1' (expect ERROR)
	ERROR: AH integrity algorithm 'aes' is not recognized
algparse -v1 'ah=vanityhash1' (expect ERROR)
	ERROR: AH integrity algorithm 'vanityhash1' is not recognized
algparse -v1 'ah=aes_gcm_c-256' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm_c' is not recognized
algparse -v1 'ah=id3' (expect ERROR)
	ERROR: AH integrity algorithm 'id3' is not recognized
algparse -v1 'ah=3des' (expect ERROR)
	ERROR: AH integrity algorithm '3des' is not recognized
algparse -v1 'ah=null' (expect ERROR)
	ERROR: AH cannot have 'none' as the integrity algorithm
algparse -v1 'ah=aes_gcm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm' is not recognized
algparse -v1 'ah=aes_ccm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_ccm' is not recognized
algparse -v1 'ah=ripemd' (expect ERROR)
	ERROR: AH integrity algorithm 'ripemd' is not recognized
algparse -v1 'ike' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256-MODP2048
	AES_CBC-HMAC_SHA2_512-MODP2048
	AES_CBC-HMAC_SHA1-MODP2048
	AES_CBC-HMAC_SHA2_256-MODP1536
	AES_CBC-HMAC_SHA2_512-MODP1536
	AES_CBC-HMAC_SHA1-MODP1536
	AES_CBC-HMAC_SHA2_256-DH19
	AES_CBC-HMAC_SHA2_512-DH19
	AES_CBC-HMAC_SHA1-DH19
	AES_CBC-HMAC_SHA2_256-DH31
	AES_CBC-HMAC_SHA2_512-DH31
	AES_CBC-HMAC_SHA1-DH31
	3DES_CBC-HMAC_SHA2_256-MODP2048
	3DES_CBC-HMAC_SHA2_512-MODP2048
	3DES_CBC-HMAC_SHA1-MODP2048
	3DES_CBC-HMAC_SHA2_256-MODP1536
	3DES_CBC-HMAC_SHA2_512-MODP1536
	3DES_CBC-HMAC_SHA1-MODP1536
	3DES_CBC-HMAC_SHA2_256-DH19
	3DES_CBC-HMAC_SHA2_512-DH19
	3DES_CBC-HMAC_SHA1-DH19
	3DES_CBC-HMAC_SHA2_256-DH31
	3DES_CBC-HMAC_SHA2_512-DH31
	3DES_CBC-HMAC_SHA1-DH31
algparse -v1 'ike=' (expect ERROR)
	ERROR: IKE proposal is empty
algparse -v1 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP2048
	3DES_CBC-HMAC_SHA1-MODP1536
	3DES_CBC-HMAC_SHA1-DH19
	3DES_CBC-HMAC_SHA1-DH31
algparse -v1 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP2048
	3DES_CBC-HMAC_SHA1-MODP1536
	3DES_CBC-HMAC_SHA1-DH19
	3DES_CBC-HMAC_SHA1-DH31
algparse -v1 'ike=3des-sha1;modp1536' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP1536
algparse -v1 'ike=3des;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA2_256-DH21
	3DES_CBC-HMAC_SHA2_512-DH21
	3DES_CBC-HMAC_SHA1-DH21
algparse -v1 'ike=3des-sha1;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v1 'ike=3des-sha1-ecp_521' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v1 'ike=3des+aes' (expect ERROR)
	ERROR: IKE encryption algorithm '3des+aes' is not recognized
algparse -v1 'ike=aes;none' (expect ERROR)
	ERROR: IKE DH algorithm 'none' is not supported by IKEv1
algparse -v1 'ike=id2' (expect ERROR)
	ERROR: IKE encryption algorithm 'id2' is not recognized
algparse -v1 'ike=3des-id2' (expect ERROR)
	ERROR: IKE PRF algorithm 'id2' is not recognized
algparse -v1 'ike=aes_ccm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_ccm' is not supported by IKEv1
algparse -v1 'ike=aes-sha1-sha2-ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v1 'ike=aes-sha2-sha2;ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v1 'ike=aes-sha1_96-sha2-ecp_521' (expect ERROR)
	ERROR: IKE PRF algorithm 'sha1_96' is not recognized
algparse -v1 'ike=aes-sha1_96-sha2;ecp_521' (expect ERROR)
	ERROR: IKE PRF algorithm 'sha1_96' is not recognized
algparse -v1 'ike=aes+aes-sha1+sha1-modp8192+modp8192' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes' is not recognized
algparse -v1 'ike=3des+aes+aes-sha2+sha1+sha1-modp4096+modp8192+modp8192' (expect ERROR)
	ERROR: IKE encryption algorithm '3des+aes+aes' is not recognized
algparse -v1 'ike=aes+3des+aes-sha1+sha2+sha1-modp8192+modp4096+modp8192' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+3des+aes' is not recognized
algparse -v1 'ike=aes+aes+3des-sha1+sha1+sha2-modp8192+modp8192+modp4096' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes+3des' is not recognized
algparse -v1 'ike=aes+aes128+aes256' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes128+aes256' is not recognized
algparse -v1 'ike=aes128+aes+aes256' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes128+aes+aes256' is not recognized
algparse -v1 'ike=aes128+aes256+aes' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes128+aes256+aes' is not recognized
algparse -v1 'ike=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
algparse -v1 'ike=aes-sha1-modp8192,aes-sha2-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
	AES_CBC-HMAC_SHA2_256-MODP8192
algparse -v1 'ike=aes_gcm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-sha2' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-sha2-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-sha2;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-none' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-none-sha2' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-none-sha2-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-none-sha2;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-none-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-none;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-sha1-none-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes_gcm-sha1-none;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 'ike=aes+aes_gcm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes_gcm' is not recognized
algparse -v1 'ike=,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=aes,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=aes,,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=-' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=+' (expect ERROR)
	ERROR: IKE encryption algorithm '+' is not recognized
algparse -v1 'ike=;' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=aes-' (expect ERROR)
	ERROR: IKE PRF algorithm '' is not recognized
algparse -v1 'ike=aes+' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+' is not recognized
algparse -v1 'ike=aes;' (expect ERROR)
	ERROR: IKE DH algorithm '' is not recognized
algparse -v1 'ike=-aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=+aes' (expect ERROR)
	ERROR: IKE encryption algorithm '+aes' is not recognized
algparse -v1 'ike=;aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 'ike=aes+-' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+' is not recognized
algparse -v1 'ike=aes+;' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+' is not recognized
algparse -v1 'ike=aes++' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes++' is not recognized
west #
 ipsec algparse -tp -v1 -pfs
algparse -v1 -pfs 'esp' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
	AES_GCM_16_128-NONE
	AES_GCM_16_256-NONE
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_512_256
	3DES_CBC-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=' (expect ERROR)
	ERROR: ESP proposal is empty
algparse -v1 -pfs 'esp=aes' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes;modp2048' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP2048
	AES_CBC-HMAC_SHA2_512_256-MODP2048
	AES_CBC-HMAC_SHA2_256_128-MODP2048
algparse -v1 -pfs 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes-sha1-modp2048' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP2048
algparse -v1 -pfs 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes-128-sha1-modp2048' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96-MODP2048
algparse -v1 -pfs 'esp=aes-128' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
	AES_CBC_128-HMAC_SHA2_512_256
	AES_CBC_128-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 -pfs 'esp=3des-sha1;modp1024' (expect ERROR)
	ERROR: ESP DH algorithm 'modp1024' is not supported
algparse -v1 -pfs 'esp=3des-sha1;modp1536' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP1536
algparse -v1 -pfs 'esp=3des-sha1;modp2048' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP2048
algparse -v1 -pfs 'esp=3des-sha1;dh21' (expect ERROR)
	ERROR: ESP DH algorithm 'dh21' is not supported by IKEv1
algparse -v1 -pfs 'esp=3des-sha1;ecp_521' (expect ERROR)
	ERROR: ESP DH algorithm 'ecp_521' is not supported by IKEv1
algparse -v1 -pfs 'esp=3des-sha1;dh23' (expect ERROR)
	ERROR: ESP DH algorithm 'dh23' is not supported
algparse -v1 -pfs 'esp=3des-sha1;dh24' (expect ERROR)
	ERROR: ESP DH algorithm 'dh24' is not supported
algparse -v1 -pfs 'esp=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96
algparse -v1 -pfs 'esp=null-sha1' (expect SUCCESS)
	NULL-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes_cbc' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
	AES_CBC-HMAC_SHA2_512_256
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes-sha' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes-sha2' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes-sha256' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes-sha384' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_384_192
algparse -v1 -pfs 'esp=aes-sha512' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256
algparse -v1 -pfs 'esp=aes128-aes_xcbc' (expect SUCCESS)
	AES_CBC_128-AES_XCBC_96
algparse -v1 -pfs 'esp=aes192-sha1' (expect SUCCESS)
	AES_CBC_192-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes256-sha1' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes256-sha' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v1 -pfs 'esp=aes256-sha2' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes256-sha2_256' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes256-sha2_384' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_384_192
algparse -v1 -pfs 'esp=aes256-sha2_512' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_512_256
algparse -v1 -pfs 'esp=camellia' (expect SUCCESS)
	CAMELLIA_CBC-HMAC_SHA1_96
	CAMELLIA_CBC-HMAC_SHA2_512_256
	CAMELLIA_CBC-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=camellia128' (expect SUCCESS)
	CAMELLIA_CBC_128-HMAC_SHA1_96
	CAMELLIA_CBC_128-HMAC_SHA2_512_256
	CAMELLIA_CBC_128-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=camellia192' (expect SUCCESS)
	CAMELLIA_CBC_192-HMAC_SHA1_96
	CAMELLIA_CBC_192-HMAC_SHA2_512_256
	CAMELLIA_CBC_192-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=camellia256' (expect SUCCESS)
	CAMELLIA_CBC_256-HMAC_SHA1_96
	CAMELLIA_CBC_256-HMAC_SHA2_512_256
	CAMELLIA_CBC_256-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes_ccm' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 -pfs 'esp=aes_ccm_a-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v1 -pfs 'esp=aes_ccm_a-192-null' (expect SUCCESS)
	AES_CCM_8_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_a-256-null' (expect SUCCESS)
	AES_CCM_8_256-NONE
algparse -v1 -pfs 'esp=aes_ccm_b-128-null' (expect SUCCESS)
	AES_CCM_12_128-NONE
algparse -v1 -pfs 'esp=aes_ccm_b-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_b-256-null' (expect SUCCESS)
	AES_CCM_12_256-NONE
algparse -v1 -pfs 'esp=aes_ccm_c-128-null' (expect SUCCESS)
	AES_CCM_16_128-NONE
algparse -v1 -pfs 'esp=aes_ccm_c-192-null' (expect SUCCESS)
	AES_CCM_16_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_c-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_gcm' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 -pfs 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 -pfs 'esp=aes_gcm_a-192-null' (expect SUCCESS)
	AES_GCM_8_192-NONE
algparse -v1 -pfs 'esp=aes_gcm_a-256-null' (expect SUCCESS)
	AES_GCM_8_256-NONE
algparse -v1 -pfs 'esp=aes_gcm_b-128-null' (expect SUCCESS)
	AES_GCM_12_128-NONE
algparse -v1 -pfs 'esp=aes_gcm_b-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v1 -pfs 'esp=aes_gcm_b-256-null' (expect SUCCESS)
	AES_GCM_12_256-NONE
algparse -v1 -pfs 'esp=aes_gcm_c-128-null' (expect SUCCESS)
	AES_GCM_16_128-NONE
algparse -v1 -pfs 'esp=aes_gcm_c-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v1 -pfs 'esp=aes_gcm_c-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_ccm_a-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v1 -pfs 'esp=aes_ccm_b-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v1 -pfs 'esp=aes_ccm_c-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 -pfs 'esp=aes_gcm_a-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v1 -pfs 'esp=aes_gcm_b-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v1 -pfs 'esp=aes_gcm_c-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 -pfs 'esp=aes_ccm-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 -pfs 'esp=aes_gcm-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 -pfs 'esp=aes_ccm-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_gcm-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_gcm_192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_8-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v1 -pfs 'esp=aes_ccm_12-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v1 -pfs 'esp=aes_ccm_16-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v1 -pfs 'esp=aes_gcm_8-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v1 -pfs 'esp=aes_gcm_12-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v1 -pfs 'esp=aes_gcm_16-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v1 -pfs 'esp=aes_ccm_8-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v1 -pfs 'esp=aes_ccm_12-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_16-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_gcm_8-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 -pfs 'esp=aes_gcm_12-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v1 -pfs 'esp=aes_gcm_16-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_ccm_8_128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v1 -pfs 'esp=aes_ccm_12_192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v1 -pfs 'esp=aes_ccm_16_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_gcm_8_128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v1 -pfs 'esp=aes_gcm_12_192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v1 -pfs 'esp=aes_gcm_16_256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v1 -pfs 'esp=aes_ctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA1_96
	AES_CTR-HMAC_SHA2_512_256
	AES_CTR-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aesctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA1_96
	AES_CTR-HMAC_SHA2_512_256
	AES_CTR-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes_ctr128' (expect SUCCESS)
	AES_CTR_128-HMAC_SHA1_96
	AES_CTR_128-HMAC_SHA2_512_256
	AES_CTR_128-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes_ctr192' (expect SUCCESS)
	AES_CTR_192-HMAC_SHA1_96
	AES_CTR_192-HMAC_SHA2_512_256
	AES_CTR_192-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=aes_ctr256' (expect SUCCESS)
	AES_CTR_256-HMAC_SHA1_96
	AES_CTR_256-HMAC_SHA2_512_256
	AES_CTR_256-HMAC_SHA2_256_128
algparse -v1 -pfs 'esp=camellia_cbc_256-hmac_sha2_512_256;modp8192' (expect SUCCESS)
	CAMELLIA_CBC_256-HMAC_SHA2_512_256-MODP8192
algparse -v1 -pfs 'esp=null_auth_aes_gmac_256-null;modp8192' (expect SUCCESS)
	NULL_AUTH_AES_GMAC_256-NONE-MODP8192
algparse -v1 -pfs 'esp=3des-sha1;modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
algparse -v1 -pfs 'esp=3des-sha1-modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
algparse -v1 -pfs 'esp=aes-sha1,3des-sha1;modp8192' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v1 -pfs 'esp=aes-sha1-modp8192,3des-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA1_96-MODP8192
algparse -v1 -pfs 'esp=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP8192
algparse -v1 -pfs 'esp=aes;none' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'esp=aes;none,aes' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'esp=aes;none,aes;modp2048' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'esp=aes-sha1-none' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'esp=aes-sha1;none' (expect ERROR)
	ERROR: ESP DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'esp=3des168-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 3DES_CBC does not allow a key lengths
algparse -v1 -pfs 'esp=3des-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm 3DES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v1 -pfs 'esp=aes128-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm AES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v1 -pfs 'esp=aes224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v1 -pfs 'esp=aes-224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v1 -pfs 'esp=aes0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v1 -pfs 'esp=aes-0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v1 -pfs 'esp=aes512-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 512 invalid; valid key lengths: 128, 192, 256
algparse -v1 -pfs 'esp=aes-sha1555' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha1555' is not recognized
algparse -v1 -pfs 'esp=camellia666-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm CAMELLIA_CBC with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v1 -pfs 'esp=blowfish' (expect ERROR)
	ERROR: ESP encryption algorithm 'blowfish' is not supported
algparse -v1 -pfs 'esp=des-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 'des' is not supported
algparse -v1 -pfs 'esp=aes_ctr666' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CTR with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v1 -pfs 'esp=aes128-sha2_128' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha2_128' is not recognized
algparse -v1 -pfs 'esp=aes256-sha2_256-4096' (expect ERROR)
	ERROR: ESP DH algorithm '4096' is not recognized
algparse -v1 -pfs 'esp=aes256-sha2_256-128' (expect ERROR)
	ERROR: ESP DH algorithm '128' is not recognized
algparse -v1 -pfs 'esp=vanitycipher' (expect ERROR)
	ERROR: ESP encryption algorithm 'vanitycipher' is not recognized
algparse -v1 -pfs 'esp=ase-sah' (expect ERROR)
	ERROR: ESP encryption algorithm 'ase' is not recognized
algparse -v1 -pfs 'esp=aes-sah1' (expect ERROR)
	ERROR: ESP integrity algorithm 'sah1' is not recognized
algparse -v1 -pfs 'esp=id3' (expect ERROR)
	ERROR: ESP encryption algorithm 'id3' is not recognized
algparse -v1 -pfs 'esp=aes-id3' (expect ERROR)
	ERROR: ESP integrity algorithm 'id3' is not recognized
algparse -v1 -pfs 'esp=aes_gcm-md5' (expect ERROR)
	ERROR: AEAD ESP encryption algorithm AES_GCM_16 must have 'NONE' as the integrity algorithm
algparse -v1 -pfs 'esp=mars' (expect ERROR)
	ERROR: ESP encryption algorithm 'mars' is not supported
algparse -v1 -pfs 'esp=aes_gcm-16' (expect ERROR)
	ERROR: ESP encryption algorithm AES_GCM_16 with key length 16 invalid; valid key lengths: 128, 192, 256
algparse -v1 -pfs 'esp=aes_gcm-0' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v1 -pfs 'esp=aes_gcm-123456789012345' (expect ERROR)
	ERROR: ESP encryption algorithm 'aes_gcm-123456789012345' key length WAY too big
algparse -v1 -pfs 'esp=3des-sha1;dh22' (expect ERROR)
	ERROR: ESP DH algorithm 'dh22' is not supported
algparse -v1 -pfs 'esp=3des-sha1;modp8192,3des-sha2' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v1 -pfs 'esp=3des-sha1-modp8192,3des-sha2' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v1 -pfs 'esp=3des-sha1-modp8192,3des-sha2-modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v1 -pfs 'esp=3des-sha1-modp8192,3des-sha2;modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v1 -pfs 'esp=3des-sha1;modp8192,3des-sha2-modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v1 -pfs 'esp=3des-sha1;modp8192,3des-sha2;modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v1 -pfs 'esp=3des-sha1-modp8192,3des-sha2-modp2048' (expect ERROR)
	ERROR: more than one IKEv1 ESP DH algorithm (MODP8192, MODP2048) is not allowed in quick mode
algparse -v1 -pfs 'ah' (expect SUCCESS)
	HMAC_SHA1_96
	HMAC_SHA2_512_256
	HMAC_SHA2_256_128
algparse -v1 -pfs 'ah=' (expect ERROR)
	ERROR: AH proposal is empty
algparse -v1 -pfs 'ah=md5' (expect SUCCESS)
	HMAC_MD5_96
algparse -v1 -pfs 'ah=sha' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v1 -pfs 'ah=sha;modp2048' (expect SUCCESS)
	HMAC_SHA1_96-MODP2048
algparse -v1 -pfs 'ah=sha1' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v1 -pfs 'ah=sha2' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v1 -pfs 'ah=sha256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v1 -pfs 'ah=sha384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v1 -pfs 'ah=sha512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v1 -pfs 'ah=sha2_256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v1 -pfs 'ah=sha2_384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v1 -pfs 'ah=sha2_512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v1 -pfs 'ah=aes_xcbc' (expect SUCCESS)
	AES_XCBC_96
algparse -v1 -pfs 'ah=sha2-none' (expect ERROR)
	ERROR: AH DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'ah=sha2;none' (expect ERROR)
	ERROR: AH DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'ah=sha1-modp8192,sha1-modp8192,sha1-modp8192' (expect SUCCESS)
	HMAC_SHA1_96-MODP8192
algparse -v1 -pfs 'ah=aes-sha1' (expect ERROR)
	ERROR: AH integrity algorithm 'aes' is not recognized
algparse -v1 -pfs 'ah=vanityhash1' (expect ERROR)
	ERROR: AH integrity algorithm 'vanityhash1' is not recognized
algparse -v1 -pfs 'ah=aes_gcm_c-256' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm_c' is not recognized
algparse -v1 -pfs 'ah=id3' (expect ERROR)
	ERROR: AH integrity algorithm 'id3' is not recognized
algparse -v1 -pfs 'ah=3des' (expect ERROR)
	ERROR: AH integrity algorithm '3des' is not recognized
algparse -v1 -pfs 'ah=null' (expect ERROR)
	ERROR: AH cannot have 'none' as the integrity algorithm
algparse -v1 -pfs 'ah=aes_gcm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm' is not recognized
algparse -v1 -pfs 'ah=aes_ccm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_ccm' is not recognized
algparse -v1 -pfs 'ah=ripemd' (expect ERROR)
	ERROR: AH integrity algorithm 'ripemd' is not recognized
algparse -v1 -pfs 'ike' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256-MODP2048
	AES_CBC-HMAC_SHA2_512-MODP2048
	AES_CBC-HMAC_SHA1-MODP2048
	AES_CBC-HMAC_SHA2_256-MODP1536
	AES_CBC-HMAC_SHA2_512-MODP1536
	AES_CBC-HMAC_SHA1-MODP1536
	AES_CBC-HMAC_SHA2_256-DH19
	AES_CBC-HMAC_SHA2_512-DH19
	AES_CBC-HMAC_SHA1-DH19
	AES_CBC-HMAC_SHA2_256-DH31
	AES_CBC-HMAC_SHA2_512-DH31
	AES_CBC-HMAC_SHA1-DH31
	3DES_CBC-HMAC_SHA2_256-MODP2048
	3DES_CBC-HMAC_SHA2_512-MODP2048
	3DES_CBC-HMAC_SHA1-MODP2048
	3DES_CBC-HMAC_SHA2_256-MODP1536
	3DES_CBC-HMAC_SHA2_512-MODP1536
	3DES_CBC-HMAC_SHA1-MODP1536
	3DES_CBC-HMAC_SHA2_256-DH19
	3DES_CBC-HMAC_SHA2_512-DH19
	3DES_CBC-HMAC_SHA1-DH19
	3DES_CBC-HMAC_SHA2_256-DH31
	3DES_CBC-HMAC_SHA2_512-DH31
	3DES_CBC-HMAC_SHA1-DH31
algparse -v1 -pfs 'ike=' (expect ERROR)
	ERROR: IKE proposal is empty
algparse -v1 -pfs 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP2048
	3DES_CBC-HMAC_SHA1-MODP1536
	3DES_CBC-HMAC_SHA1-DH19
	3DES_CBC-HMAC_SHA1-DH31
algparse -v1 -pfs 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP2048
	3DES_CBC-HMAC_SHA1-MODP1536
	3DES_CBC-HMAC_SHA1-DH19
	3DES_CBC-HMAC_SHA1-DH31
algparse -v1 -pfs 'ike=3des-sha1;modp1536' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP1536
algparse -v1 -pfs 'ike=3des;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA2_256-DH21
	3DES_CBC-HMAC_SHA2_512-DH21
	3DES_CBC-HMAC_SHA1-DH21
algparse -v1 -pfs 'ike=3des-sha1;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v1 -pfs 'ike=3des-sha1-ecp_521' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v1 -pfs 'ike=3des+aes' (expect ERROR)
	ERROR: IKE encryption algorithm '3des+aes' is not recognized
algparse -v1 -pfs 'ike=aes;none' (expect ERROR)
	ERROR: IKE DH algorithm 'none' is not supported by IKEv1
algparse -v1 -pfs 'ike=id2' (expect ERROR)
	ERROR: IKE encryption algorithm 'id2' is not recognized
algparse -v1 -pfs 'ike=3des-id2' (expect ERROR)
	ERROR: IKE PRF algorithm 'id2' is not recognized
algparse -v1 -pfs 'ike=aes_ccm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_ccm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes-sha1-sha2-ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v1 -pfs 'ike=aes-sha2-sha2;ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v1 -pfs 'ike=aes-sha1_96-sha2-ecp_521' (expect ERROR)
	ERROR: IKE PRF algorithm 'sha1_96' is not recognized
algparse -v1 -pfs 'ike=aes-sha1_96-sha2;ecp_521' (expect ERROR)
	ERROR: IKE PRF algorithm 'sha1_96' is not recognized
algparse -v1 -pfs 'ike=aes+aes-sha1+sha1-modp8192+modp8192' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes' is not recognized
algparse -v1 -pfs 'ike=3des+aes+aes-sha2+sha1+sha1-modp4096+modp8192+modp8192' (expect ERROR)
	ERROR: IKE encryption algorithm '3des+aes+aes' is not recognized
algparse -v1 -pfs 'ike=aes+3des+aes-sha1+sha2+sha1-modp8192+modp4096+modp8192' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+3des+aes' is not recognized
algparse -v1 -pfs 'ike=aes+aes+3des-sha1+sha1+sha2-modp8192+modp8192+modp4096' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes+3des' is not recognized
algparse -v1 -pfs 'ike=aes+aes128+aes256' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes128+aes256' is not recognized
algparse -v1 -pfs 'ike=aes128+aes+aes256' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes128+aes+aes256' is not recognized
algparse -v1 -pfs 'ike=aes128+aes256+aes' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes128+aes256+aes' is not recognized
algparse -v1 -pfs 'ike=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
algparse -v1 -pfs 'ike=aes-sha1-modp8192,aes-sha2-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
	AES_CBC-HMAC_SHA2_256-MODP8192
algparse -v1 -pfs 'ike=aes_gcm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-sha2' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-sha2-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-sha2;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-none' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-none-sha2' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-none-sha2-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-none-sha2;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-none-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-none;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-sha1-none-modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes_gcm-sha1-none;modp2048' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_gcm' is not supported by IKEv1
algparse -v1 -pfs 'ike=aes+aes_gcm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+aes_gcm' is not recognized
algparse -v1 -pfs 'ike=,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=aes,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=aes,,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=-' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=+' (expect ERROR)
	ERROR: IKE encryption algorithm '+' is not recognized
algparse -v1 -pfs 'ike=;' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=aes-' (expect ERROR)
	ERROR: IKE PRF algorithm '' is not recognized
algparse -v1 -pfs 'ike=aes+' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+' is not recognized
algparse -v1 -pfs 'ike=aes;' (expect ERROR)
	ERROR: IKE DH algorithm '' is not recognized
algparse -v1 -pfs 'ike=-aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=+aes' (expect ERROR)
	ERROR: IKE encryption algorithm '+aes' is not recognized
algparse -v1 -pfs 'ike=;aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v1 -pfs 'ike=aes+-' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+' is not recognized
algparse -v1 -pfs 'ike=aes+;' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes+' is not recognized
algparse -v1 -pfs 'ike=aes++' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes++' is not recognized
west #
 ipsec algparse -tp -v2
algparse -v2 'esp' (expect SUCCESS)
	AES_GCM_16_256-NONE
	AES_GCM_16_128-NONE
	CHACHA20_POLY1305-NONE
	AES_CBC_256-HMAC_SHA2_512_256+HMAC_SHA2_256_128
	AES_CBC_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=' (expect ERROR)
	ERROR: ESP proposal is empty
algparse -v2 'esp=aes' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes;modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1-modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 'esp=aes-128-sha1-modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 'esp=aes-128' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 'esp=3des-sha1;modp1024' (expect ERROR)
	ERROR: ESP DH algorithm 'modp1024' is not supported
algparse -v2 'esp=3des-sha1;modp1536' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP1536 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=3des-sha1;modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=3des-sha1;dh21' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm DH21 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=3des-sha1;ecp_521' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm DH21 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=3des-sha1;dh23' (expect ERROR)
	ERROR: ESP DH algorithm 'dh23' is not supported
algparse -v2 'esp=3des-sha1;dh24' (expect ERROR)
	ERROR: ESP DH algorithm 'dh24' is not supported
algparse -v2 'esp=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=null-sha1' (expect SUCCESS)
	NULL-HMAC_SHA1_96
algparse -v2 'esp=aes_cbc' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes-sha' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 'esp=aes-sha2' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=aes-sha256' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=aes-sha384' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_384_192
algparse -v2 'esp=aes-sha512' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256
algparse -v2 'esp=aes128-aes_xcbc' (expect SUCCESS)
	AES_CBC_128-AES_XCBC_96
algparse -v2 'esp=aes192-sha1' (expect SUCCESS)
	AES_CBC_192-HMAC_SHA1_96
algparse -v2 'esp=aes256-sha1' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v2 'esp=aes256-sha' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v2 'esp=aes256-sha2' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v2 'esp=aes256-sha2_256' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v2 'esp=aes256-sha2_384' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_384_192
algparse -v2 'esp=aes256-sha2_512' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_512_256
algparse -v2 'esp=camellia' (expect SUCCESS)
	CAMELLIA_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=camellia128' (expect SUCCESS)
	CAMELLIA_CBC_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=camellia192' (expect SUCCESS)
	CAMELLIA_CBC_192-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=camellia256' (expect SUCCESS)
	CAMELLIA_CBC_256-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes_ccm' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 'esp=aes_ccm_a-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v2 'esp=aes_ccm_a-192-null' (expect SUCCESS)
	AES_CCM_8_192-NONE
algparse -v2 'esp=aes_ccm_a-256-null' (expect SUCCESS)
	AES_CCM_8_256-NONE
algparse -v2 'esp=aes_ccm_b-128-null' (expect SUCCESS)
	AES_CCM_12_128-NONE
algparse -v2 'esp=aes_ccm_b-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v2 'esp=aes_ccm_b-256-null' (expect SUCCESS)
	AES_CCM_12_256-NONE
algparse -v2 'esp=aes_ccm_c-128-null' (expect SUCCESS)
	AES_CCM_16_128-NONE
algparse -v2 'esp=aes_ccm_c-192-null' (expect SUCCESS)
	AES_CCM_16_192-NONE
algparse -v2 'esp=aes_ccm_c-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 'esp=aes_gcm' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 'esp=aes_gcm_a-192-null' (expect SUCCESS)
	AES_GCM_8_192-NONE
algparse -v2 'esp=aes_gcm_a-256-null' (expect SUCCESS)
	AES_GCM_8_256-NONE
algparse -v2 'esp=aes_gcm_b-128-null' (expect SUCCESS)
	AES_GCM_12_128-NONE
algparse -v2 'esp=aes_gcm_b-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v2 'esp=aes_gcm_b-256-null' (expect SUCCESS)
	AES_GCM_12_256-NONE
algparse -v2 'esp=aes_gcm_c-128-null' (expect SUCCESS)
	AES_GCM_16_128-NONE
algparse -v2 'esp=aes_gcm_c-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v2 'esp=aes_gcm_c-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v2 'esp=aes_ccm_a-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v2 'esp=aes_ccm_b-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v2 'esp=aes_ccm_c-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 'esp=aes_gcm_a-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v2 'esp=aes_gcm_b-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v2 'esp=aes_gcm_c-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 'esp=aes_ccm-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 'esp=aes_gcm-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 'esp=aes_ccm-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 'esp=aes_gcm-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v2 'esp=aes_ccm_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 'esp=aes_gcm_192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v2 'esp=aes_ccm_8-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v2 'esp=aes_ccm_12-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v2 'esp=aes_ccm_16-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 'esp=aes_gcm_8-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v2 'esp=aes_gcm_12-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v2 'esp=aes_gcm_16-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 'esp=aes_ccm_8-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v2 'esp=aes_ccm_12-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v2 'esp=aes_ccm_16-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 'esp=aes_gcm_8-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 'esp=aes_gcm_12-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v2 'esp=aes_gcm_16-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v2 'esp=aes_ccm_8_128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v2 'esp=aes_ccm_12_192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v2 'esp=aes_ccm_16_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 'esp=aes_gcm_8_128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 'esp=aes_gcm_12_192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v2 'esp=aes_gcm_16_256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v2 'esp=aes_ctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aesctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes_ctr128' (expect SUCCESS)
	AES_CTR_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes_ctr192' (expect SUCCESS)
	AES_CTR_192-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes_ctr256' (expect SUCCESS)
	AES_CTR_256-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=camellia_cbc_256-hmac_sha2_512_256;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	CAMELLIA_CBC_256-HMAC_SHA2_512_256
algparse -v2 'esp=null_auth_aes_gmac_256-null;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	NULL_AUTH_AES_GMAC_256-NONE
algparse -v2 'esp=3des-sha1;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=3des-sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1,3des-sha1;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1-modp8192,3des-sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes;none' (expect SUCCESS)
ipsec algparse: ignoring redundant ESP DH algorithm NONE as PFS policy is disabled
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes;none,aes' (expect SUCCESS)
ipsec algparse: ignoring redundant ESP DH algorithm NONE as PFS policy is disabled
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes;none,aes;modp2048' (expect SUCCESS)
ipsec algparse: ignoring redundant ESP DH algorithm NONE as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 'esp=aes-sha1-none' (expect SUCCESS)
ipsec algparse: ignoring redundant ESP DH algorithm NONE as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=aes-sha1;none' (expect SUCCESS)
ipsec algparse: ignoring redundant ESP DH algorithm NONE as PFS policy is disabled
	AES_CBC-HMAC_SHA1_96
algparse -v2 'esp=3des168-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 3DES_CBC does not allow a key lengths
algparse -v2 'esp=3des-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm 3DES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v2 'esp=aes128-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm AES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v2 'esp=aes224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v2 'esp=aes-224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v2 'esp=aes0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v2 'esp=aes-0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v2 'esp=aes512-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 512 invalid; valid key lengths: 128, 192, 256
algparse -v2 'esp=aes-sha1555' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha1555' is not recognized
algparse -v2 'esp=camellia666-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm CAMELLIA_CBC with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v2 'esp=blowfish' (expect ERROR)
	ERROR: ESP encryption algorithm 'blowfish' is not supported
algparse -v2 'esp=des-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 'des' is not supported
algparse -v2 'esp=aes_ctr666' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CTR with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v2 'esp=aes128-sha2_128' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha2_128' is not recognized
algparse -v2 'esp=aes256-sha2_256-4096' (expect ERROR)
	ERROR: ESP DH algorithm '4096' is not recognized
algparse -v2 'esp=aes256-sha2_256-128' (expect ERROR)
	ERROR: ESP DH algorithm '128' is not recognized
algparse -v2 'esp=vanitycipher' (expect ERROR)
	ERROR: ESP encryption algorithm 'vanitycipher' is not recognized
algparse -v2 'esp=ase-sah' (expect ERROR)
	ERROR: ESP encryption algorithm 'ase' is not recognized
algparse -v2 'esp=aes-sah1' (expect ERROR)
	ERROR: ESP integrity algorithm 'sah1' is not recognized
algparse -v2 'esp=id3' (expect ERROR)
	ERROR: ESP encryption algorithm 'id3' is not recognized
algparse -v2 'esp=aes-id3' (expect ERROR)
	ERROR: ESP integrity algorithm 'id3' is not recognized
algparse -v2 'esp=aes_gcm-md5' (expect ERROR)
	ERROR: AEAD ESP encryption algorithm AES_GCM_16 must have 'NONE' as the integrity algorithm
algparse -v2 'esp=mars' (expect ERROR)
	ERROR: ESP encryption algorithm 'mars' is not supported
algparse -v2 'esp=aes_gcm-16' (expect ERROR)
	ERROR: ESP encryption algorithm AES_GCM_16 with key length 16 invalid; valid key lengths: 128, 192, 256
algparse -v2 'esp=aes_gcm-0' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v2 'esp=aes_gcm-123456789012345' (expect ERROR)
	ERROR: ESP encryption algorithm 'aes_gcm-123456789012345' key length WAY too big
algparse -v2 'esp=3des-sha1;dh22' (expect ERROR)
	ERROR: ESP DH algorithm 'dh22' is not supported
algparse -v2 'esp=3des-sha1;modp8192,3des-sha2' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=3des-sha1-modp8192,3des-sha2' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=3des-sha1-modp8192,3des-sha2-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=3des-sha1-modp8192,3des-sha2;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=3des-sha1;modp8192,3des-sha2-modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=3des-sha1;modp8192,3des-sha2;modp8192' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'esp=3des-sha1-modp8192,3des-sha2-modp2048' (expect SUCCESS)
ipsec algparse: ignoring ESP DH algorithm MODP8192 as PFS policy is disabled
ipsec algparse: ignoring ESP DH algorithm MODP2048 as PFS policy is disabled
	3DES_CBC-HMAC_SHA1_96
	3DES_CBC-HMAC_SHA2_256_128
algparse -v2 'ah' (expect SUCCESS)
	HMAC_SHA2_512_256
	HMAC_SHA2_256_128
algparse -v2 'ah=' (expect ERROR)
	ERROR: AH proposal is empty
algparse -v2 'ah=md5' (expect SUCCESS)
	HMAC_MD5_96
algparse -v2 'ah=sha' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v2 'ah=sha;modp2048' (expect SUCCESS)
ipsec algparse: ignoring AH DH algorithm MODP2048 as PFS policy is disabled
	HMAC_SHA1_96
algparse -v2 'ah=sha1' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v2 'ah=sha2' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v2 'ah=sha256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v2 'ah=sha384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v2 'ah=sha512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v2 'ah=sha2_256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v2 'ah=sha2_384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v2 'ah=sha2_512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v2 'ah=aes_xcbc' (expect SUCCESS)
	AES_XCBC_96
algparse -v2 'ah=sha2-none' (expect SUCCESS)
ipsec algparse: ignoring redundant AH DH algorithm NONE as PFS policy is disabled
	HMAC_SHA2_256_128
algparse -v2 'ah=sha2;none' (expect SUCCESS)
ipsec algparse: ignoring redundant AH DH algorithm NONE as PFS policy is disabled
	HMAC_SHA2_256_128
algparse -v2 'ah=sha1-modp8192,sha1-modp8192,sha1-modp8192' (expect SUCCESS)
ipsec algparse: ignoring AH DH algorithm MODP8192 as PFS policy is disabled
	HMAC_SHA1_96
algparse -v2 'ah=aes-sha1' (expect ERROR)
	ERROR: AH integrity algorithm 'aes' is not recognized
algparse -v2 'ah=vanityhash1' (expect ERROR)
	ERROR: AH integrity algorithm 'vanityhash1' is not recognized
algparse -v2 'ah=aes_gcm_c-256' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm_c' is not recognized
algparse -v2 'ah=id3' (expect ERROR)
	ERROR: AH integrity algorithm 'id3' is not recognized
algparse -v2 'ah=3des' (expect ERROR)
	ERROR: AH integrity algorithm '3des' is not recognized
algparse -v2 'ah=null' (expect ERROR)
	ERROR: AH cannot have 'none' as the integrity algorithm
algparse -v2 'ah=aes_gcm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm' is not recognized
algparse -v2 'ah=aes_ccm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_ccm' is not recognized
algparse -v2 'ah=ripemd' (expect ERROR)
	ERROR: AH integrity algorithm 'ripemd' is not recognized
algparse -v2 'ike' (expect SUCCESS)
	AES_GCM_16_256-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	AES_GCM_16_128-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	CHACHA20_POLY1305-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	AES_CBC_256-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	AES_CBC_128-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=' (expect ERROR)
	ERROR: IKE proposal is empty
algparse -v2 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=3des-sha1;modp1536' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP1536
algparse -v2 'ike=3des;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH21
algparse -v2 'ike=3des-sha1;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v2 'ike=3des-sha1-ecp_521' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v2 'ike=3des+aes' (expect SUCCESS)
	3DES_CBC+AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes;none' (expect ERROR)
	ERROR: IKE DH algorithm 'none' not permitted
algparse -v2 'ike=id2' (expect ERROR)
	ERROR: IKE encryption algorithm 'id2' is not recognized
algparse -v2 'ike=3des-id2' (expect ERROR)
	ERROR: IKE PRF algorithm 'id2' is not recognized
algparse -v2 'ike=aes_ccm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_ccm' is not supported
algparse -v2 'ike=aes-sha1-sha2-ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v2 'ike=aes-sha2-sha2;ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v2 'ike=aes-sha1_96-sha2-ecp_521' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-HMAC_SHA2_256-DH21
algparse -v2 'ike=aes-sha1_96-sha2;ecp_521' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-HMAC_SHA2_256-DH21
algparse -v2 'ike=aes+aes-sha1+sha1-modp8192+modp8192' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	AES_CBC-HMAC_SHA1-MODP8192
algparse -v2 'ike=3des+aes+aes-sha2+sha1+sha1-modp4096+modp8192+modp8192' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	3DES_CBC+AES_CBC-HMAC_SHA2_256+HMAC_SHA1-MODP4096+MODP8192
algparse -v2 'ike=aes+3des+aes-sha1+sha2+sha1-modp8192+modp4096+modp8192' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	AES_CBC+3DES_CBC-HMAC_SHA1+HMAC_SHA2_256-MODP8192+MODP4096
algparse -v2 'ike=aes+aes+3des-sha1+sha1+sha2-modp8192+modp8192+modp4096' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	AES_CBC+3DES_CBC-HMAC_SHA1+HMAC_SHA2_256-MODP8192+MODP4096
algparse -v2 'ike=aes+aes128+aes256' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC_128
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC_256
	AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes128+aes+aes256' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC_256
	AES_CBC_128+AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes128+aes256+aes' (expect SUCCESS)
	AES_CBC_128+AES_CBC_256+AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
algparse -v2 'ike=aes-sha1-modp8192,aes-sha2-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
	AES_CBC-HMAC_SHA2_256-MODP8192
algparse -v2 'ike=aes_gcm' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes_gcm-sha2' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes_gcm-sha2-modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 'ike=aes_gcm-sha2;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 'ike=aes_gcm-modp2048' (expect ERROR)
	ERROR: IKE PRF algorithm 'modp2048' is not recognized
algparse -v2 'ike=aes_gcm;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-MODP2048
algparse -v2 'ike=aes_gcm-none' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes_gcm-none-sha2' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 'ike=aes_gcm-none-sha2-modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 'ike=aes_gcm-none-sha2;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 'ike=aes_gcm-none-modp2048' (expect ERROR)
	ERROR: IKE PRF algorithm 'modp2048' is not recognized
algparse -v2 'ike=aes_gcm-none;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-MODP2048
algparse -v2 'ike=aes_gcm-sha1-none-modp2048' (expect ERROR)
	ERROR: IKE proposal contains unexpected 'modp2048'
algparse -v2 'ike=aes_gcm-sha1-none;modp2048' (expect ERROR)
	ERROR: IKE proposal contains unexpected 'modp2048'
algparse -v2 'ike=aes+aes_gcm' (expect ERROR)
	ERROR: AEAD and non-AEAD IKE encryption algorithm cannot be combined
algparse -v2 'ike=,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes,,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=-' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=+' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=;' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes-' (expect ERROR)
	ERROR: IKE PRF algorithm is empty
algparse -v2 'ike=aes+' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes;' (expect ERROR)
	ERROR: IKE DH algorithm is empty
algparse -v2 'ike=-aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=+aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=;aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes+-' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes+;' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 'ike=aes++' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
west #
 ipsec algparse -tp -v2 -pfs
algparse -v2 -pfs 'esp' (expect SUCCESS)
	AES_GCM_16_256-NONE
	AES_GCM_16_128-NONE
	CHACHA20_POLY1305-NONE
	AES_CBC_256-HMAC_SHA2_512_256+HMAC_SHA2_256_128
	AES_CBC_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=' (expect ERROR)
	ERROR: ESP proposal is empty
algparse -v2 -pfs 'esp=aes' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes;modp2048' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128-MODP2048
algparse -v2 -pfs 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes-sha1-modp2048' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP2048
algparse -v2 -pfs 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes-128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes-128-sha1-modp2048' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96-MODP2048
algparse -v2 -pfs 'esp=aes-128' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 -pfs 'esp=3des-sha1;modp1024' (expect ERROR)
	ERROR: ESP DH algorithm 'modp1024' is not supported
algparse -v2 -pfs 'esp=3des-sha1;modp1536' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP1536
algparse -v2 -pfs 'esp=3des-sha1;modp2048' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP2048
algparse -v2 -pfs 'esp=3des-sha1;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-DH21
algparse -v2 -pfs 'esp=3des-sha1;ecp_521' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-DH21
algparse -v2 -pfs 'esp=3des-sha1;dh23' (expect ERROR)
	ERROR: ESP DH algorithm 'dh23' is not supported
algparse -v2 -pfs 'esp=3des-sha1;dh24' (expect ERROR)
	ERROR: ESP DH algorithm 'dh24' is not supported
algparse -v2 -pfs 'esp=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96
algparse -v2 -pfs 'esp=null-sha1' (expect SUCCESS)
	NULL-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes_cbc' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes-sha' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes-sha1' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes128-sha1' (expect SUCCESS)
	AES_CBC_128-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes-sha2' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes-sha256' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes-sha384' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_384_192
algparse -v2 -pfs 'esp=aes-sha512' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256
algparse -v2 -pfs 'esp=aes128-aes_xcbc' (expect SUCCESS)
	AES_CBC_128-AES_XCBC_96
algparse -v2 -pfs 'esp=aes192-sha1' (expect SUCCESS)
	AES_CBC_192-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes256-sha1' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes256-sha' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA1_96
algparse -v2 -pfs 'esp=aes256-sha2' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes256-sha2_256' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes256-sha2_384' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_384_192
algparse -v2 -pfs 'esp=aes256-sha2_512' (expect SUCCESS)
	AES_CBC_256-HMAC_SHA2_512_256
algparse -v2 -pfs 'esp=camellia' (expect SUCCESS)
	CAMELLIA_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=camellia128' (expect SUCCESS)
	CAMELLIA_CBC_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=camellia192' (expect SUCCESS)
	CAMELLIA_CBC_192-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=camellia256' (expect SUCCESS)
	CAMELLIA_CBC_256-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes_ccm' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 -pfs 'esp=aes_ccm_a-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v2 -pfs 'esp=aes_ccm_a-192-null' (expect SUCCESS)
	AES_CCM_8_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_a-256-null' (expect SUCCESS)
	AES_CCM_8_256-NONE
algparse -v2 -pfs 'esp=aes_ccm_b-128-null' (expect SUCCESS)
	AES_CCM_12_128-NONE
algparse -v2 -pfs 'esp=aes_ccm_b-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_b-256-null' (expect SUCCESS)
	AES_CCM_12_256-NONE
algparse -v2 -pfs 'esp=aes_ccm_c-128-null' (expect SUCCESS)
	AES_CCM_16_128-NONE
algparse -v2 -pfs 'esp=aes_ccm_c-192-null' (expect SUCCESS)
	AES_CCM_16_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_c-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_gcm' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 -pfs 'esp=aes_gcm_a-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 -pfs 'esp=aes_gcm_a-192-null' (expect SUCCESS)
	AES_GCM_8_192-NONE
algparse -v2 -pfs 'esp=aes_gcm_a-256-null' (expect SUCCESS)
	AES_GCM_8_256-NONE
algparse -v2 -pfs 'esp=aes_gcm_b-128-null' (expect SUCCESS)
	AES_GCM_12_128-NONE
algparse -v2 -pfs 'esp=aes_gcm_b-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v2 -pfs 'esp=aes_gcm_b-256-null' (expect SUCCESS)
	AES_GCM_12_256-NONE
algparse -v2 -pfs 'esp=aes_gcm_c-128-null' (expect SUCCESS)
	AES_GCM_16_128-NONE
algparse -v2 -pfs 'esp=aes_gcm_c-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v2 -pfs 'esp=aes_gcm_c-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_ccm_a-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v2 -pfs 'esp=aes_ccm_b-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v2 -pfs 'esp=aes_ccm_c-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 -pfs 'esp=aes_gcm_a-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v2 -pfs 'esp=aes_gcm_b-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v2 -pfs 'esp=aes_gcm_c-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 -pfs 'esp=aes_ccm-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 -pfs 'esp=aes_gcm-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 -pfs 'esp=aes_ccm-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_gcm-192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_gcm_192-null' (expect SUCCESS)
	AES_GCM_16_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_8-null' (expect SUCCESS)
	AES_CCM_8-NONE
algparse -v2 -pfs 'esp=aes_ccm_12-null' (expect SUCCESS)
	AES_CCM_12-NONE
algparse -v2 -pfs 'esp=aes_ccm_16-null' (expect SUCCESS)
	AES_CCM_16-NONE
algparse -v2 -pfs 'esp=aes_gcm_8-null' (expect SUCCESS)
	AES_GCM_8-NONE
algparse -v2 -pfs 'esp=aes_gcm_12-null' (expect SUCCESS)
	AES_GCM_12-NONE
algparse -v2 -pfs 'esp=aes_gcm_16-null' (expect SUCCESS)
	AES_GCM_16-NONE
algparse -v2 -pfs 'esp=aes_ccm_8-128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v2 -pfs 'esp=aes_ccm_12-192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_16-256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_gcm_8-128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 -pfs 'esp=aes_gcm_12-192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v2 -pfs 'esp=aes_gcm_16-256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_ccm_8_128-null' (expect SUCCESS)
	AES_CCM_8_128-NONE
algparse -v2 -pfs 'esp=aes_ccm_12_192-null' (expect SUCCESS)
	AES_CCM_12_192-NONE
algparse -v2 -pfs 'esp=aes_ccm_16_256-null' (expect SUCCESS)
	AES_CCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_gcm_8_128-null' (expect SUCCESS)
	AES_GCM_8_128-NONE
algparse -v2 -pfs 'esp=aes_gcm_12_192-null' (expect SUCCESS)
	AES_GCM_12_192-NONE
algparse -v2 -pfs 'esp=aes_gcm_16_256-null' (expect SUCCESS)
	AES_GCM_16_256-NONE
algparse -v2 -pfs 'esp=aes_ctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aesctr' (expect SUCCESS)
	AES_CTR-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes_ctr128' (expect SUCCESS)
	AES_CTR_128-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes_ctr192' (expect SUCCESS)
	AES_CTR_192-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=aes_ctr256' (expect SUCCESS)
	AES_CTR_256-HMAC_SHA2_512_256+HMAC_SHA2_256_128
algparse -v2 -pfs 'esp=camellia_cbc_256-hmac_sha2_512_256;modp8192' (expect SUCCESS)
	CAMELLIA_CBC_256-HMAC_SHA2_512_256-MODP8192
algparse -v2 -pfs 'esp=null_auth_aes_gmac_256-null;modp8192' (expect SUCCESS)
	NULL_AUTH_AES_GMAC_256-NONE-MODP8192
algparse -v2 -pfs 'esp=3des-sha1;modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
algparse -v2 -pfs 'esp=3des-sha1-modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
algparse -v2 -pfs 'esp=aes-sha1,3des-sha1;modp8192' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v2 -pfs 'esp=aes-sha1-modp8192,3des-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA1_96-MODP8192
algparse -v2 -pfs 'esp=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-MODP8192
algparse -v2 -pfs 'esp=aes;none' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128-NONE
algparse -v2 -pfs 'esp=aes;none,aes' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v2 -pfs 'esp=aes;none,aes;modp2048' (expect SUCCESS)
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128-NONE
	AES_CBC-HMAC_SHA2_512_256+HMAC_SHA2_256_128-MODP2048
algparse -v2 -pfs 'esp=aes-sha1-none' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-NONE
algparse -v2 -pfs 'esp=aes-sha1;none' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-NONE
algparse -v2 -pfs 'esp=3des168-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 3DES_CBC does not allow a key lengths
algparse -v2 -pfs 'esp=3des-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm 3DES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v2 -pfs 'esp=aes128-null' (expect ERROR)
	ERROR: non-AEAD ESP encryption algorithm AES_CBC cannot have 'NONE' as the integrity algorithm
algparse -v2 -pfs 'esp=aes224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v2 -pfs 'esp=aes-224-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 224 invalid; valid key lengths: 128, 192, 256
algparse -v2 -pfs 'esp=aes0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v2 -pfs 'esp=aes-0-sha1' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v2 -pfs 'esp=aes512-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CBC with key length 512 invalid; valid key lengths: 128, 192, 256
algparse -v2 -pfs 'esp=aes-sha1555' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha1555' is not recognized
algparse -v2 -pfs 'esp=camellia666-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm CAMELLIA_CBC with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v2 -pfs 'esp=blowfish' (expect ERROR)
	ERROR: ESP encryption algorithm 'blowfish' is not supported
algparse -v2 -pfs 'esp=des-sha1' (expect ERROR)
	ERROR: ESP encryption algorithm 'des' is not supported
algparse -v2 -pfs 'esp=aes_ctr666' (expect ERROR)
	ERROR: ESP encryption algorithm AES_CTR with key length 666 invalid; valid key lengths: 128, 192, 256
algparse -v2 -pfs 'esp=aes128-sha2_128' (expect ERROR)
	ERROR: ESP integrity algorithm 'sha2_128' is not recognized
algparse -v2 -pfs 'esp=aes256-sha2_256-4096' (expect ERROR)
	ERROR: ESP DH algorithm '4096' is not recognized
algparse -v2 -pfs 'esp=aes256-sha2_256-128' (expect ERROR)
	ERROR: ESP DH algorithm '128' is not recognized
algparse -v2 -pfs 'esp=vanitycipher' (expect ERROR)
	ERROR: ESP encryption algorithm 'vanitycipher' is not recognized
algparse -v2 -pfs 'esp=ase-sah' (expect ERROR)
	ERROR: ESP encryption algorithm 'ase' is not recognized
algparse -v2 -pfs 'esp=aes-sah1' (expect ERROR)
	ERROR: ESP integrity algorithm 'sah1' is not recognized
algparse -v2 -pfs 'esp=id3' (expect ERROR)
	ERROR: ESP encryption algorithm 'id3' is not recognized
algparse -v2 -pfs 'esp=aes-id3' (expect ERROR)
	ERROR: ESP integrity algorithm 'id3' is not recognized
algparse -v2 -pfs 'esp=aes_gcm-md5' (expect ERROR)
	ERROR: AEAD ESP encryption algorithm AES_GCM_16 must have 'NONE' as the integrity algorithm
algparse -v2 -pfs 'esp=mars' (expect ERROR)
	ERROR: ESP encryption algorithm 'mars' is not supported
algparse -v2 -pfs 'esp=aes_gcm-16' (expect ERROR)
	ERROR: ESP encryption algorithm AES_GCM_16 with key length 16 invalid; valid key lengths: 128, 192, 256
algparse -v2 -pfs 'esp=aes_gcm-0' (expect ERROR)
	ERROR: ESP encryption key length is zero
algparse -v2 -pfs 'esp=aes_gcm-123456789012345' (expect ERROR)
	ERROR: ESP encryption algorithm 'aes_gcm-123456789012345' key length WAY too big
algparse -v2 -pfs 'esp=3des-sha1;dh22' (expect ERROR)
	ERROR: ESP DH algorithm 'dh22' is not supported
algparse -v2 -pfs 'esp=3des-sha1;modp8192,3des-sha2' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v2 -pfs 'esp=3des-sha1-modp8192,3des-sha2' (expect ERROR)
	ERROR: either all or no ESP proposals should specify DH
algparse -v2 -pfs 'esp=3des-sha1-modp8192,3des-sha2-modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v2 -pfs 'esp=3des-sha1-modp8192,3des-sha2;modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v2 -pfs 'esp=3des-sha1;modp8192,3des-sha2-modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v2 -pfs 'esp=3des-sha1;modp8192,3des-sha2;modp8192' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1_96-MODP8192
	3DES_CBC-HMAC_SHA2_256_128-MODP8192
algparse -v2 -pfs 'esp=3des-sha1-modp8192,3des-sha2-modp2048' (expect ERROR)
	ERROR: more than one IKEv2 ESP DH algorithm (MODP8192, MODP2048) requires unimplemented CHILD_SA INVALID_KE
algparse -v2 -pfs 'ah' (expect SUCCESS)
	HMAC_SHA2_512_256
	HMAC_SHA2_256_128
algparse -v2 -pfs 'ah=' (expect ERROR)
	ERROR: AH proposal is empty
algparse -v2 -pfs 'ah=md5' (expect SUCCESS)
	HMAC_MD5_96
algparse -v2 -pfs 'ah=sha' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v2 -pfs 'ah=sha;modp2048' (expect SUCCESS)
	HMAC_SHA1_96-MODP2048
algparse -v2 -pfs 'ah=sha1' (expect SUCCESS)
	HMAC_SHA1_96
algparse -v2 -pfs 'ah=sha2' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v2 -pfs 'ah=sha256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v2 -pfs 'ah=sha384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v2 -pfs 'ah=sha512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v2 -pfs 'ah=sha2_256' (expect SUCCESS)
	HMAC_SHA2_256_128
algparse -v2 -pfs 'ah=sha2_384' (expect SUCCESS)
	HMAC_SHA2_384_192
algparse -v2 -pfs 'ah=sha2_512' (expect SUCCESS)
	HMAC_SHA2_512_256
algparse -v2 -pfs 'ah=aes_xcbc' (expect SUCCESS)
	AES_XCBC_96
algparse -v2 -pfs 'ah=sha2-none' (expect SUCCESS)
	HMAC_SHA2_256_128-NONE
algparse -v2 -pfs 'ah=sha2;none' (expect SUCCESS)
	HMAC_SHA2_256_128-NONE
algparse -v2 -pfs 'ah=sha1-modp8192,sha1-modp8192,sha1-modp8192' (expect SUCCESS)
	HMAC_SHA1_96-MODP8192
algparse -v2 -pfs 'ah=aes-sha1' (expect ERROR)
	ERROR: AH integrity algorithm 'aes' is not recognized
algparse -v2 -pfs 'ah=vanityhash1' (expect ERROR)
	ERROR: AH integrity algorithm 'vanityhash1' is not recognized
algparse -v2 -pfs 'ah=aes_gcm_c-256' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm_c' is not recognized
algparse -v2 -pfs 'ah=id3' (expect ERROR)
	ERROR: AH integrity algorithm 'id3' is not recognized
algparse -v2 -pfs 'ah=3des' (expect ERROR)
	ERROR: AH integrity algorithm '3des' is not recognized
algparse -v2 -pfs 'ah=null' (expect ERROR)
	ERROR: AH cannot have 'none' as the integrity algorithm
algparse -v2 -pfs 'ah=aes_gcm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_gcm' is not recognized
algparse -v2 -pfs 'ah=aes_ccm' (expect ERROR)
	ERROR: AH integrity algorithm 'aes_ccm' is not recognized
algparse -v2 -pfs 'ah=ripemd' (expect ERROR)
	ERROR: AH integrity algorithm 'ripemd' is not recognized
algparse -v2 -pfs 'ike' (expect SUCCESS)
	AES_GCM_16_256-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	AES_GCM_16_128-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	CHACHA20_POLY1305-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	AES_CBC_256-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
	AES_CBC_128-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=' (expect ERROR)
	ERROR: IKE proposal is empty
algparse -v2 -pfs 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=3des-sha1' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=3des-sha1;modp1536' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-MODP1536
algparse -v2 -pfs 'ike=3des;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH21
algparse -v2 -pfs 'ike=3des-sha1;dh21' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v2 -pfs 'ike=3des-sha1-ecp_521' (expect SUCCESS)
	3DES_CBC-HMAC_SHA1-DH21
algparse -v2 -pfs 'ike=3des+aes' (expect SUCCESS)
	3DES_CBC+AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes;none' (expect ERROR)
	ERROR: IKE DH algorithm 'none' not permitted
algparse -v2 -pfs 'ike=id2' (expect ERROR)
	ERROR: IKE encryption algorithm 'id2' is not recognized
algparse -v2 -pfs 'ike=3des-id2' (expect ERROR)
	ERROR: IKE PRF algorithm 'id2' is not recognized
algparse -v2 -pfs 'ike=aes_ccm' (expect ERROR)
	ERROR: IKE encryption algorithm 'aes_ccm' is not supported
algparse -v2 -pfs 'ike=aes-sha1-sha2-ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v2 -pfs 'ike=aes-sha2-sha2;ecp_521' (expect ERROR)
	ERROR: IKE DH algorithm 'sha2' is not recognized
algparse -v2 -pfs 'ike=aes-sha1_96-sha2-ecp_521' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-HMAC_SHA2_256-DH21
algparse -v2 -pfs 'ike=aes-sha1_96-sha2;ecp_521' (expect SUCCESS)
	AES_CBC-HMAC_SHA1_96-HMAC_SHA2_256-DH21
algparse -v2 -pfs 'ike=aes+aes-sha1+sha1-modp8192+modp8192' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	AES_CBC-HMAC_SHA1-MODP8192
algparse -v2 -pfs 'ike=3des+aes+aes-sha2+sha1+sha1-modp4096+modp8192+modp8192' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	3DES_CBC+AES_CBC-HMAC_SHA2_256+HMAC_SHA1-MODP4096+MODP8192
algparse -v2 -pfs 'ike=aes+3des+aes-sha1+sha2+sha1-modp8192+modp4096+modp8192' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	AES_CBC+3DES_CBC-HMAC_SHA1+HMAC_SHA2_256-MODP8192+MODP4096
algparse -v2 -pfs 'ike=aes+aes+3des-sha1+sha1+sha2-modp8192+modp8192+modp4096' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC
ipsec algparse: discarding duplicate IKE PRF algorithm HMAC_SHA1
ipsec algparse: discarding duplicate IKE DH algorithm MODP8192
	AES_CBC+3DES_CBC-HMAC_SHA1+HMAC_SHA2_256-MODP8192+MODP4096
algparse -v2 -pfs 'ike=aes+aes128+aes256' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC_128
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC_256
	AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes128+aes+aes256' (expect SUCCESS)
ipsec algparse: discarding duplicate IKE encryption algorithm AES_CBC_256
	AES_CBC_128+AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes128+aes256+aes' (expect SUCCESS)
	AES_CBC_128+AES_CBC_256+AES_CBC-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes-sha1-modp8192,aes-sha1-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
algparse -v2 -pfs 'ike=aes-sha1-modp8192,aes-sha2-modp8192,aes-sha1-modp8192' (expect SUCCESS)
	AES_CBC-HMAC_SHA1-MODP8192
	AES_CBC-HMAC_SHA2_256-MODP8192
algparse -v2 -pfs 'ike=aes_gcm' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes_gcm-sha2' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes_gcm-sha2-modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 -pfs 'ike=aes_gcm-sha2;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 -pfs 'ike=aes_gcm-modp2048' (expect ERROR)
	ERROR: IKE PRF algorithm 'modp2048' is not recognized
algparse -v2 -pfs 'ike=aes_gcm;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-MODP2048
algparse -v2 -pfs 'ike=aes_gcm-none' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes_gcm-none-sha2' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-DH19+DH20+DH21+DH31+MODP4096+MODP3072+MODP2048+MODP8192
algparse -v2 -pfs 'ike=aes_gcm-none-sha2-modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 -pfs 'ike=aes_gcm-none-sha2;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_256-MODP2048
algparse -v2 -pfs 'ike=aes_gcm-none-modp2048' (expect ERROR)
	ERROR: IKE PRF algorithm 'modp2048' is not recognized
algparse -v2 -pfs 'ike=aes_gcm-none;modp2048' (expect SUCCESS)
	AES_GCM_16-HMAC_SHA2_512+HMAC_SHA2_256-MODP2048
algparse -v2 -pfs 'ike=aes_gcm-sha1-none-modp2048' (expect ERROR)
	ERROR: IKE proposal contains unexpected 'modp2048'
algparse -v2 -pfs 'ike=aes_gcm-sha1-none;modp2048' (expect ERROR)
	ERROR: IKE proposal contains unexpected 'modp2048'
algparse -v2 -pfs 'ike=aes+aes_gcm' (expect ERROR)
	ERROR: AEAD and non-AEAD IKE encryption algorithm cannot be combined
algparse -v2 -pfs 'ike=,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes,' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes,,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=,aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=-' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=+' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=;' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes-' (expect ERROR)
	ERROR: IKE PRF algorithm is empty
algparse -v2 -pfs 'ike=aes+' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes;' (expect ERROR)
	ERROR: IKE DH algorithm is empty
algparse -v2 -pfs 'ike=-aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=+aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=;aes' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes+-' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes+;' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
algparse -v2 -pfs 'ike=aes++' (expect ERROR)
	ERROR: IKE encryption algorithm is empty
west #
 # Run the algorithm tests; there should be no fails.
west #
 ipsec algparse -ta > /dev/null
west #
 # Check pluto is starting in the correct mode.
west #
 ipsec start
Redirecting to: [initsystem]
west #
 ../../guestbin/wait-until-pluto-started
west #
 grep ^FIPS /tmp/pluto.log
FIPS Mode: OFF
FIPS mode disabled for pluto daemon
FIPS HMAC integrity support [not required]
west #
 # Check pluto algorithm list.
west #
 sed -n -e '/^|/d' -e ':algs / algorithms:/ { :alg ; p ; n ; /^  / b alg ; b algs }' /tmp/pluto.log
Encryption algorithms:
  AES_CCM_16         {256,192,*128} IKEv1:     ESP     IKEv2:     ESP     FIPS              aes_ccm, aes_ccm_c
  AES_CCM_12         {256,192,*128} IKEv1:     ESP     IKEv2:     ESP     FIPS              aes_ccm_b
  AES_CCM_8          {256,192,*128} IKEv1:     ESP     IKEv2:     ESP     FIPS              aes_ccm_a
  3DES_CBC           [*192]         IKEv1: IKE ESP     IKEv2: IKE ESP     FIPS NSS(CBC)     3des
  CAMELLIA_CTR       {256,192,*128} IKEv1:     ESP     IKEv2:     ESP                      
  CAMELLIA_CBC       {256,192,*128} IKEv1: IKE ESP     IKEv2: IKE ESP          NSS(CBC)     camellia
  AES_GCM_16         {256,192,*128} IKEv1:     ESP     IKEv2: IKE ESP     FIPS NSS(AEAD)    aes_gcm, aes_gcm_c
  AES_GCM_12         {256,192,*128} IKEv1:     ESP     IKEv2: IKE ESP     FIPS NSS(AEAD)    aes_gcm_b
  AES_GCM_8          {256,192,*128} IKEv1:     ESP     IKEv2: IKE ESP     FIPS NSS(AEAD)    aes_gcm_a
  AES_CTR            {256,192,*128} IKEv1: IKE ESP     IKEv2: IKE ESP     FIPS NSS(CTR)     aesctr
  AES_CBC            {256,192,*128} IKEv1: IKE ESP     IKEv2: IKE ESP     FIPS NSS(CBC)     aes
  NULL_AUTH_AES_GMAC {256,192,*128} IKEv1:     ESP     IKEv2:     ESP     FIPS              aes_gmac
  NULL               []             IKEv1:     ESP     IKEv2:     ESP          NULL        
  CHACHA20_POLY1305  [*256]         IKEv1:             IKEv2: IKE ESP          NSS(AEAD)    chacha20poly1305
Hash algorithms:
  MD5                               IKEv1: IKE         IKEv2:                  NSS         
  SHA1                              IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha
  SHA2_256                          IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha2, sha256
  SHA2_384                          IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha384
  SHA2_512                          IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha512
  IDENTITY                          IKEv1:             IKEv2:             FIPS             
PRF algorithms:
  HMAC_MD5                          IKEv1: IKE         IKEv2: IKE              NSS          md5
  HMAC_SHA1                         IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha, sha1
  HMAC_SHA2_256                     IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha2, sha256, sha2_256
  HMAC_SHA2_384                     IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha384, sha2_384
  HMAC_SHA2_512                     IKEv1: IKE         IKEv2: IKE         FIPS NSS          sha512, sha2_512
  AES_XCBC                          IKEv1:             IKEv2: IKE              native(XCBC) aes128_xcbc
Integrity algorithms:
  HMAC_MD5_96                       IKEv1: IKE ESP AH  IKEv2: IKE ESP AH       NSS          md5, hmac_md5
  HMAC_SHA1_96                      IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS          sha, sha1, sha1_96, hmac_sha1
  HMAC_SHA2_512_256                 IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS          sha512, sha2_512, sha2_512_256, hmac_sha2_512
  HMAC_SHA2_384_192                 IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS          sha384, sha2_384, sha2_384_192, hmac_sha2_384
  HMAC_SHA2_256_128                 IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS          sha2, sha256, sha2_256, sha2_256_128, hmac_sha2_256
  HMAC_SHA2_256_TRUNCBUG            IKEv1:     ESP AH  IKEv2:         AH                   
  AES_XCBC_96                       IKEv1:     ESP AH  IKEv2: IKE ESP AH       native(XCBC) aes_xcbc, aes128_xcbc, aes128_xcbc_96
  AES_CMAC_96                       IKEv1:     ESP AH  IKEv2:     ESP AH  FIPS              aes_cmac
  NONE                              IKEv1:     ESP     IKEv2: IKE ESP     FIPS              null
DH algorithms:
  NONE                              IKEv1:             IKEv2: IKE ESP AH  FIPS NSS(MODP)    null, dh0
  MODP1536                          IKEv1: IKE ESP AH  IKEv2: IKE ESP AH       NSS(MODP)    dh5
  MODP2048                          IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS(MODP)    dh14
  MODP3072                          IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS(MODP)    dh15
  MODP4096                          IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS(MODP)    dh16
  MODP6144                          IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS(MODP)    dh17
  MODP8192                          IKEv1: IKE ESP AH  IKEv2: IKE ESP AH  FIPS NSS(MODP)    dh18
  DH19                              IKEv1: IKE         IKEv2: IKE ESP AH  FIPS NSS(ECP)     ecp_256, ecp256
  DH20                              IKEv1: IKE         IKEv2: IKE ESP AH  FIPS NSS(ECP)     ecp_384, ecp384
  DH21                              IKEv1: IKE         IKEv2: IKE ESP AH  FIPS NSS(ECP)     ecp_521, ecp521
  DH31                              IKEv1: IKE         IKEv2: IKE ESP AH       NSS(ECP)     curve25519
  DH36                              IKEv1: IKE         IKEv2: IKE ESP AH       NSS(KEM)     ml_kem_768
IPCOMP algorithms:
  DEFLATE                           IKEv1:     ESP AH  IKEv2:     ESP AH  FIPS             
  LZS                               IKEv1:             IKEv2:     ESP AH  FIPS             
  LZJH                              IKEv1:             IKEv2:     ESP AH  FIPS             
west #
 
